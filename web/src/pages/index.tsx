import Head from 'next/head'
import Image from 'next/image'
import { Inter } from 'next/font/google'
import styles from '@/styles/Home.module.css'
import { invoke } from '@tauri-apps/api/tauri'
import Button from '@mui/material/Button';
import TextField from "@mui/material/TextField";
import Stack from "@mui/material/Stack";
import Checkbox from "@mui/material/Checkbox";
import {FormControlLabel, Typography} from "@mui/material";
import {useState} from "react";

const inter = Inter({ subsets: ['latin'] })

export default function Home() {
  const [isMainPlayer, setIsMainPlayer] = useState(false);
  const onMainPlayerChange = (e: any) => setIsMainPlayer(!isMainPlayer);
  const [player0, setPlayer0] = useState("");
  const onPlayer0Change = (e: any) => setPlayer0(e.target.value);
  const [player1, setPlayer1] = useState("");
  const onPlayer1Change = (e: any) => setPlayer1(e.target.value);
  const [roomId, setRoomId] = useState("");
  const onRoomChange = (e: any) => setRoomId(e.target.value);

  const isClient = typeof window !== 'undefined'
  const onSubmit = () => {
    if (isClient) {
      const args = {
        isMainPlayer: isMainPlayer,
        playerId0Json: `"${player0}"`,
        playerId1Json: `"${player1}"`,
        roomIdJson: `"${roomId}"`,
      };
      invoke(
        'join_game',
        args
      ).then(console.log).catch(console.error)
    } else {
      alert("Only implemented in native client")
    }
  };


  return (
    <>
      <Head>
        <title>Create Next App</title>
        <meta name="description" content="Generated by create next app" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <link rel="icon" href="/favicon.ico" />
      </Head>
      <main className={styles.main}>
        <Stack spacing={2} sx={{ width: "100%", maxWidth: "500px", marginTop: "5rem" }}>
          <Typography variant="h3">Join game</Typography>
          <FormControlLabel
            value={isMainPlayer} onChange={onMainPlayerChange}
            control={<Checkbox defaultChecked id="is-main-player" />} label="Is main player" />
          <TextField
            value={roomId} onChange={onRoomChange}
            required={true} id="room-id" label="Room ID" variant="outlined" />
          <TextField
            value={player0} onChange={onPlayer0Change}
            required={true} id="player-0" label="Player #0 ID" variant="outlined" />
          <TextField
            value={player1} onChange={onPlayer1Change}
            required={true} id="player-1" label="Player #1 ID" variant="outlined" />
          <Button onClick={onSubmit} variant="contained">Start</Button>
        </Stack>
      </main>
    </>
  )
}
